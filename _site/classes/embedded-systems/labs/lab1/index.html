<!DOCTYPE html><html lang="en-US"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script src="/assets/js/vendor/lunr.min.js"></script> <script src="/assets/js/just-the-docs.js"></script><meta name="viewport" content="width=device-width, initial-scale=1"><title>Lab 1 | HThreads</title><meta name="generator" content="Jekyll v3.9.3" /><meta property="og:title" content="Lab 1" /><meta name="author" content="Kevin Lin" /><meta property="og:locale" content="en_US" /><meta name="description" content="A modern, highly customizable, responsive Jekyll template for course websites" /><meta property="og:description" content="A modern, highly customizable, responsive Jekyll template for course websites" /><link rel="canonical" href="http://localhost:4000/classes/embedded-systems/labs/lab1/" /><meta property="og:url" content="http://localhost:4000/classes/embedded-systems/labs/lab1/" /><meta property="og:site_name" content="HThreads" /><meta property="og:type" content="website" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Lab 1" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"Kevin Lin"},"description":"A modern, highly customizable, responsive Jekyll template for course websites","headline":"Lab 1","url":"http://localhost:4000/classes/embedded-systems/labs/lab1/"}</script><body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"><title>Link</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"><title>Menu</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"><title>Expand</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"><polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"><title id="svg-external-link-title">(external link)</title><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"><title>Document</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"><path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"><title>Search</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-copy" viewBox="0 0 16 16"><title>Copy</title><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/><path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"><title>Copied</title><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"><path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg><div class="side-bar"><div class="site-header"> <a href="/" class="site-title lh-tight"> HThreads </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a></div><nav aria-label="Main" id="site-nav" class="site-nav"><ul class="nav-list"><li class="nav-list-item"><a href="/" class="nav-list-link">Home</a><li class="nav-list-item"><a href="#" class="nav-list-expander" aria-label="toggle links in Classes category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/classes/" class="nav-list-link">Classes</a><ul class="nav-list"><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in EECS 4213 Computer Architecture category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/classes/computer-architecture/" class="nav-list-link">EECS 4213 Computer Architecture</a><ul class="nav-list"><li class="nav-list-item "> <a href="/classes/computer-architecture/syllabus/" class="nav-list-link">Syllabus</a><li class="nav-list-item "> <a href="/classes/computer-architecture/schedule/" class="nav-list-link">Schedule</a></ul><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in EECS 4114 Embedded Systems category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/classes/embedded-systems/" class="nav-list-link">EECS 4114 Embedded Systems</a><ul class="nav-list"><li class="nav-list-item "> <a href="/classes/embedded-systems/syllabus/" class="nav-list-link">Syllabus</a><li class="nav-list-item "> <a href="/classes/embedded-systems/schedule/" class="nav-list-link">Schedule</a><li class="nav-list-item "> <a href="/classes/embedded-systems/labs/" class="nav-list-link">Labs</a></ul></ul><li class="nav-list-item"><a href="/people/" class="nav-list-link">People</a><li class="nav-list-item"><a href="#" class="nav-list-expander" aria-label="toggle links in Projects category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/projects/" class="nav-list-link">Projects</a><ul class="nav-list"><li class="nav-list-item "><a href="/projects/picaso/" class="nav-list-link">PiCaSO</a></ul><li class="nav-list-item"><a href="/publications/" class="nav-list-link">Publications</a><li class="nav-list-item"><a href="/schedule/" class="nav-list-link">Schedule</a></ul></nav><footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</footer></div><div class="main" id="top"><div id="main-header" class="main-header"><div class="search"><div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search HThreads" aria-label="Search HThreads" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label></div><div id="search-results" class="search-results"></div></div></div><div id="main-content-wrap" class="main-content-wrap"><nav aria-label="Breadcrumb" class="breadcrumb-nav"><ol class="breadcrumb-nav-list"><li class="breadcrumb-nav-list-item"> <a href="/classes/">Classes</a><li class="breadcrumb-nav-list-item"> <a href="/classes/embedded-systems/">EECS 4114 Embedded Systems</a><li class="breadcrumb-nav-list-item"> <a href="/classes/embedded-systems/labs/">Labs</a><li class="breadcrumb-nav-list-item"> <span>Lab 1</span></ol></nav><div id="main-content" class="main-content" role="main"><h1 id="lab-1-building-a-basic-soc"> <a href="#lab-1-building-a-basic-soc" class="anchor-heading" aria-labelledby="lab-1-building-a-basic-soc"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Lab 1: Building A Basic SoC</h1><h2 id="description"> <a href="#description" class="anchor-heading" aria-labelledby="description"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Description</h2><p>In laboratory 1 you will complete a provided boilerplate design of a <a href="https://en.wikipedia.org/wiki/System_on_a_chip">System-on-Chip (SoC)</a> using the Xilinx-Vivado development suite and targeted at the <a href="https://www.xilinx.com/products/boards-and-kits/1-elhaap.html">Arty-A7-35</a> development board. Your design will contain a MicroBlaze soft processor, a USB UART serial controller, and a DDR memory controller that interfaces with components on the Arty board. The processor will be connected to the serial port and DDR memory peripherals in a shared-bus architecture. You will then program this SoC using the C programming language to print out your name and student ID five times to the screen of a desktop computer which is connected to the Arty-7 development board using the USB serial port. There will be 2 screenshot requirements for your report, so ensure you read the following instructions carefully.</p><h2 id="project-assignment"> <a href="#project-assignment" class="anchor-heading" aria-labelledby="project-assignment"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Project Assignment</h2><p>Use the provided base project to create a basic system-on-chip and add a UART serial controller to your SoC. Synthesize your system-on-chip, compile your software project, combine them into a bitstream, and download it onto the Arty-A7-35 development board. Create a software project and make it print out your name five times.</p><p>This may not seem like much, but at the end of this laboratory, you will have created a system-on-chip and executed a program on top of it in a bare metal environment. This represents a rudimentary but fully functional embedded system.</p><h2 id="directions"> <a href="#directions" class="anchor-heading" aria-labelledby="directions"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Directions</h2><p><strong>Preamble - Adding Arty board to Vivado:</strong></p><p>Before opening Vivado, visit <a href="https://digilent.com/reference/programmable-logic/guides/installing-vivado-and-vitis">Digilent’s website</a> and follow the instructions listed under “Install Digilent’s Board Files”. The instructions will provide you with a <a href="https://github.com/Digilent/vivado-boards/archive/master.zip">download link</a> for the board files. When you extract the archive, you only need to install the “arty-a7-35” directory, other boards are not necessary for our purposes.</p><p><strong>Vivado - Generating a bitstream:</strong></p><ol><li>Start by downloading the base <a href="https://github.com/tkamucheka/eecs-4114-labs">SoC project from GitHub</a>.<ul><li><em><strong>NB:</strong> Windows users - Extract the downloaded files to a directory close to your system root directory. E.g. <code class="language-plaintext highlighter-rouge">C:\Users\[username]\Desktop\eecs-4114-labs</code>. Visit <a href="https://learn.microsoft.com/en-us/windows/win32/fileio/maximum-file-path-limitation?tabs=registry">this page</a> for Windows path character limit details.</em></ul><li>Open the downloaded project in Vivado 2019.1.<ul><li><strong>Option 1:</strong> In the project folder (e.g. <code class="language-plaintext highlighter-rouge">C:\Users\[username]\Desktop\eecs-4114-labs\base-soc</code>), double-click the file <strong>base-soc.xpr</strong><li><strong>Option 2:</strong> Start by opening Vivado 2019.1. On the welcome screen, select “Open Project”. Use the dialog to navigate to your project directory, and open the <strong>base-soc.xpr</strong> file.</ul><li>In the left panel, “Flow Navigator”, select the “Open Block Design” option. <img src="/classes/embedded-systems/labs/lab1/assets/base_soc.png" alt="Base SoC Design" /> If you are prompted.<li>Add the AXI UARTlite soft-ip core to the design.<ol><li>Right-click anywhere in the board design window and select “<strong>+ Add IP…</strong>”.<li>Enter “Uartlite” in the search window and double-click on the “AXI Uartlite” option. The AXI Uartlite soft-ip core should appear in the block design along with a green bar at the top of the window.<li>In the green bar, select “Run Connection Automation”. Then, in the “Run Connection Automation” window, check the “UART” checkbox under “<strong>axi_uartlite..</strong>” and click “OK”. <em><strong>Important:</strong> leave the S_AXI box unchecked.</em><li>Almost there… Right-click the <strong>S_AXI</strong> port on the AXI Uartlite core and select “Make Connection…”. In the “Make Connection” window, select the <strong>M00_AXI</strong> under <strong>microblaze_0_axi_periph</strong> and click “OK” to make the connection.<li>Finally, select “Run Connection Automation” again. Select <strong>s_axi_clk</strong> under <strong>axi_uartlite..</strong> and change the “Clock Source:” option to <strong><code class="language-plaintext highlighter-rouge">/mig_7series_0/ui_clk (81 MHz)</code></strong>. Click “OK” to automate the connection of the clock and reset ports.<li>You may need to assign an address to the AXI Uartlite soft-ip. Open the “Address Editor” window and verify that an address has been assigned to “axi_uartlite..”. If not, right-click on “axi_uartlite..” and select “Auto Assign Address”. <img src="/classes/embedded-systems/labs/lab1/assets/addressing.png" alt="Auto Assign UART Address" /></ol><li>In the “Sources” window, right-click on the “base_soc.bd” file and select “Create HDL Wrapper…”. The “base_soc.bd” file should now be nested inside “base_soc_wrapper.v” file.<li>Back in the “Flow Navigator” window, select “Generate Bitstream” to synthesize your design. This may take a while…<li>After generating a bitstream, select “File &gt; Export &gt; Export Hardware” in the top menu. Then in the export window, select the “Include bitstream” option before exporting your design.</ol><p><strong>SDK - Creating Software Project:</strong></p><ol><li>To open the SDK environment, select “File &gt; Launch SDK” in the top menu.<li>In the SDK, select “File &gt; New &gt; Application Project”.<ol><li>Start by entering a name for your project. E.g. “lab1”<li><strong>OS Platform:</strong> should be set to “standalone”<li><strong>Hardware Platform:</strong> default setting, “soc_wrapper_hw_platform_0”<li><strong>Processor:</strong> default setting, “microblaze_0”<li><strong>Language:</strong> C<li><strong>Board Support Package:</strong> Create New - e.g. “lab1_bsp”<li>Select “Next” to open the application templates page.</ol><li>Select the “Hello World” template, and click “Finish” to create your application project.<li>In the “Project Explorer” window, open the file <code class="language-plaintext highlighter-rouge">lab1/src/helloworld.c</code><li>Edit this program to print your name and student ID 5 times.<li><strong>Pause!</strong> Now is a good time to make sure your FPGA dev board is plugged in.<li>Establish a serial connection with the FPGA’s serial port.<ol><li>Open the “SDK Terminal” window. It will be in the bottom-center panel.<li>Click on the plus icon to open the “Connect to serial port” dialog.<li><strong>Port:</strong> Select a COM port from the dropdown list. If there is more than one option, the COM port with the highest numerical suffix is usually the correct option.<li><strong>Baud Rate:</strong> 9600<li><strong>Data bits:</strong> 8<li><strong>Stop bits:</strong> 1<li><strong>Parity:</strong> None<li><strong>Flow Control:</strong> None<li>Click “OK” to start the connection.</ol><li>Combine your hardware design and application project into a single bitstream and load it onto your FPGA board.<ol><li>Start by selecting “Xilinx &gt; Program FPGA” in the top menu. Nothing to change on this window, select “Program” to load the bitstream onto the FPGA.<li>Next, select “Run &gt; Run As &gt; Launch On Hardware (System Debugger)”<li>Alternatively, select “Launch On Hardware (GDB)” to launch the application in debug mode where you will have the option to step through the program. Use this option when debugging your applications.</ol></ol><h2 id="submission"> <a href="#submission" class="anchor-heading" aria-labelledby="submission"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Submission</h2><ol><li>Prepare a lab report: (Use the lab report template provided)<ul><li>Give an account of what you did in this lab, what you learned, and anything you found interesting.<li>Include the screenshots of your Uartlite controller and neighboring components and the output of your “SDK Terminal” window.<li>Include essential relevant screenshots, diagrams, and code snippets necessary to your writing in the report.</ul><li>Submit, separately, all your code files (e.g. the “helloworld.c” file).<ul><li><em><strong>NB: DO NOT</strong> paste your code in your lab report.</em></ul></ol><h2 id="prelab-questions"> <a href="#prelab-questions" class="anchor-heading" aria-labelledby="prelab-questions"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Prelab Questions</h2><ol><li>What is an FPGA?<li>What is a system-on-chip? Why is it different from your desktop computer system?<li>What does soft-core IP mean?<li>What does it mean to cross-compile a program?<li>Why does it take so long to configure/build the Hardware portion of your system on the FPGA?<li>How does the desktop computer program the FPGA, how does it monitor the FPGA?</ol></div></div><div class="search-overlay"></div></div>
